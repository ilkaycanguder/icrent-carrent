@model EditCredentialsViewModel
@{
    ViewData["Title"] = "Hesabı Güncelle";
    Layout = "_Layout";
}

<style>
    /* ===== Auth Settings – Neon Scope ===== */
    .account-scope {
        --neon: #0ef29b;
        --neon2: #7dfcc4;
        --ink: #212529;
        --muted: #6c757d;
        --edge: rgba(14,242,155,.24);
        --card: #fff;
        --glow: 0 12px 28px rgba(14,242,155,.18);
    }

        .account-scope .card-neon {
            border: 1px solid var(--edge);
            background: var(--card);
            border-radius: 22px;
            box-shadow: var(--glow), 0 6px 18px rgba(0,0,0,.06);
            overflow: hidden;
        }

        .account-scope .cap {
            height: 16px;
            background: linear-gradient(180deg,var(--neon),var(--neon2));
        }

        .account-scope .page-title {
            font-weight: 800;
            letter-spacing: .2px;
        }

        .account-scope .page-subtitle {
            color: var(--muted);
        }

        .account-scope .form-control {
            border-radius: 14px;
            border-color: rgba(0,0,0,.08);
        }

            .account-scope .form-control:focus {
                box-shadow: 0 0 0 .25rem rgba(14,242,155,.28);
                border-color: var(--neon);
            }

        .account-scope .input-group-text {
            border-radius: 14px;
            border-color: rgba(0,0,0,.08);
            background: #f8fffB;
        }

        .account-scope .btn-eye {
            border: 2px solid var(--neon);
            border-radius: 12px;
            background: #fff;
        }

            .account-scope .btn-eye:hover {
                background: rgba(14,242,155,.10);
                box-shadow: var(--glow);
            }

        .account-scope .btn-neon {
            border: 0;
            border-radius: 14px;
            font-weight: 700;
            background-image: linear-gradient(90deg,var(--neon),var(--neon2));
            color: #0c5132;
            box-shadow: 0 10px 24px rgba(14,242,155,.32);
        }

            .account-scope .btn-neon:hover {
                filter: brightness(.98);
            }

        .account-scope .text-danger {
            font-weight: 600;
        }

        .account-scope .help {
            color: var(--muted);
            font-size: .9rem;
        }
</style>

<div class="container account-scope">
    <div class="card card-neon p-0 mx-auto my-4" style="max-width: 640px;">
        <div class="cap"></div>
        <div class="p-4 p-md-5">

            <h2 class="mb-2 text-center page-title">
                <i class="bi bi-gear"></i> Hesabı Güncelle
            </h2>
            <p class="text-center page-subtitle mb-4">Kullanıcı adını ve şifreni güvenle güncelle.</p>

            @*   @if (TempData["Success"] != null)
            {
                <div class="alert alert-success">@TempData["Success"]</div>
            } *@
            @if (ViewBag.ProfileUpdated == true)
            {
                <div id="profileSaved" class="alert alert-success mb-3" style="transition:opacity .4s ease; opacity:1">
                    @(ViewBag.SuccessText ?? "Bilgileriniz güncellendi. 2 saniye içinde giriş ekranına yönlendirileceksiniz.")
                </div>
            }

            <form asp-action="EditProfile" method="post" novalidate>
                <div class="mb-3">
                    <label asp-for="UserName" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-person"></i></span>
                        <input asp-for="UserName" class="form-control form-control-lg" placeholder="kullaniciadiniz" />
                    </div>
                    <div class="help mt-1">3–50 karakter. Boşluk ve özel karakterlerden kaçının.</div>
                    <span asp-validation-for="UserName" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="CurrentPassword" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-lock"></i></span>
                        <input asp-for="CurrentPassword" class="form-control form-control-lg" placeholder="Mevcut şifreniz" />
                        <button class="btn btn-eye" type="button" data-eye="CurrentPassword" aria-label="Şifreyi göster/gizle">
                            <i class="bi bi-eye"></i>
                        </button>
                    </div>
                    <span asp-validation-for="CurrentPassword" class="text-danger"></span>
                </div>

                <div class="mb-3">
                    <label asp-for="NewPassword" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-shield-lock"></i></span>
                        <input asp-for="NewPassword" class="form-control form-control-lg" placeholder="Yeni şifreniz" />
                        <button class="btn btn-eye" type="button" data-eye="NewPassword" aria-label="Şifreyi göster/gizle">
                            <i class="bi bi-eye"></i>
                        </button>
                    </div>
                    <div class="help mt-1">En az 6 karakter. Güçlü bir şifre önerilir.</div>
                    <span asp-validation-for="NewPassword" class="text-danger"></span>
                </div>

                <div class="mb-4">
                    <label asp-for="ConfirmNewPassword" class="form-label fw-semibold"></label>
                    <div class="input-group">
                        <span class="input-group-text"><i class="bi bi-check2"></i></span>
                        <input asp-for="ConfirmNewPassword" class="form-control form-control-lg" placeholder="Yeni şifre (tekrar)" />
                        <button class="btn btn-eye" type="button" data-eye="ConfirmNewPassword" aria-label="Şifreyi göster/gizle">
                            <i class="bi bi-eye"></i>
                        </button>
                    </div>
                    <span asp-validation-for="ConfirmNewPassword" class="text-danger"></span>
                </div>

                <button type="submit" class="btn btn-neon w-100 py-2">
                    <i class="bi bi-check2-circle me-1"></i> Kaydet
                </button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
            (function () {
          const box = document.getElementById('profileSaved');
          if (!box) return;
          // 2 sn bekle → fade → Logout (→ Login)
            setTimeout(() => {
            box.style.opacity = '0';
            setTimeout(() => {
            window.location.href = '@Url.Action("Logout", "Account", new { next = "login" })';
                  }, 400); // fade süresi
          }, 2000);
        })();
        // Şifre göz ikonu (3 alan için ortak)
        (function(){
          document.querySelectorAll("[data-eye]").forEach(btn=>{
            btn.addEventListener("click", function(){
              const key = this.getAttribute("data-eye");
              const input = document.getElementById(key);
              if(!input) return;
              const show = input.type === "password";
              input.type = show ? "text" : "password";
              this.innerHTML = show ? '<i class="bi bi-eye-slash"></i>' : '<i class="bi bi-eye"></i>';
            });
          });
        })();
    </script>
}
